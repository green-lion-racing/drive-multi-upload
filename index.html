<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      /**
       * ResumableUploadToGoogleDrive for Javascript library
       * GitHub  https://github.com/tanaikech/ResumableUploadForGoogleDrive_js<br>
       * In this Class ResumableUploadToGoogleDrive, the selected file is uploaded by splitting data on the memory.<br>
       */
      (function(r) {
        let ResumableUploadToGoogleDrive;
        ResumableUploadToGoogleDrive = (function() {
          function ResumableUploadToGoogleDrive() {
            this.obj = {};
            this.chunkSize = 5242880; // must be higher or equal 262144, in best case a multiple of it
            this.partsOfChunks = 10;
            this.endpoint = "https://www.googleapis.com/upload/drive/v3/files?uploadType=resumable&supportsAllDrives=true";
          }

          /**
           * Run resumable upload a file.
           * @param {Object} resource the object for resumable uploading a file.
           */
          ResumableUploadToGoogleDrive.prototype.Do = async function(resource, callback) {
            callback({
              status: "initialize"
            }, null);
            try {
              this.obj = await init.call(this, resource);
            } catch (err) {
              callback(null, err);
              return;
            }
            const uint8Array = new Uint8Array(this.obj.resource.fileBuffer);
            const chunkPot = getChunkPot.call(this);
            const chunks = chunkPot.chunks.map(function(e) {
              return {
                data: uint8Array.slice(e.startByte, e.endByte + 1),
                length: e.numByte,
                range: "bytes " + e.startByte + "-" + e.endByte + "/" + chunkPot.total,
                startByte: e.startByte,
                endByte: e.endByte,
                total: chunkPot.total,
              };
            });
            try {
              const head = await getLocation.call(this);
              this.location = head.get("location");
              callback({
                status: "getLocation"
              }, null);
              doUpload.call(this, chunks, function(res, err) {
                if (err) {
                  callback(null, err);
                  return;
                }
                callback(res, null);
                return;
              });
            } catch (err) {
              callback(null, err);
              return;
            }
          };

          const init = function(resource) {
            return new Promise((resolve, reject) => {
              if (
                !("accessToken" in resource) ||
                !("fileName" in resource) ||
                !("fileSize" in resource) ||
                !("fileType" in resource) ||
                !("fileBuffer" in resource)
              ) {
                reject({
                  Error: "There are no required parameters. accessToken, fileName, fileSize, fileType and fileBuffer are required.",
                });
                return;
              }
              let object = {};
              object.resource = resource;
              if (
                "chunkSize" in resource &&
                resource.chunkSize >= 262144 &&
                resource.chunkSize % 262144 == 0
              ) {
                this.chunkSize = resource.chunkSize;
              }
              if (
                "partsOfChunks" in resource &&
                resource.partsOfChunks <= 20 &&
                resource.partsOfChunks === parseInt(resource.partsOfChunks, 10)
              ) {
                this.partsOfChunks = resource.partsOfChunks;
              }
              if ("fields" in resource && resource.fields != "") {
                this.endpoint += "&fields=" + encodeURIComponent(resource.fields);
              }
              if ("convertToGoogleDocs" in resource && resource.convertToGoogleDocs) {
                fetch(
                    "https://www.googleapis.com/drive/v3/about?fields=importFormats", {
                      method: "GET",
                      headers: {
                        Authorization: "Bearer " + resource.accessToken
                      },
                    }
                  )
                  .then((res) => {
                    if (res.status != 200) {
                      res.json().then((e) => reject(e));
                      return;
                    }
                    res.json().then((res) => {
                      if (resource.fileType in res.importFormats) {
                        object.resource.fileType =
                          res.importFormats[resource.fileType][0];
                      }
                      resolve(object);
                    });
                  })
                  .catch((err) => {
                    reject(err);
                  });
              } else {
                resolve(object);
              }
            });
          };

          const getChunkPot = function() {
            const chunkSize = this.chunkSize;
            const fileSize = this.obj.resource.fileSize;
            let chunkPot = {};
            chunkPot.total = fileSize;
            chunkPot.chunks = [];
            let numE =
              fileSize > chunkSize ?
              chunkSize :
              Math.ceil(fileSize / (262144 * this.partsOfChunks)) * 262144;
            const endS = (function(f, n) {
              const c = f % n;
              if (c == 0) {
                return 0;
              } else {
                return c;
              }
            })(fileSize, numE);
            const repeat = Math.floor(fileSize / numE);
            for (let i = 0; i <= repeat; i++) {
              const startAddress = i * numE;
              let c = {};
              c.startByte = startAddress;
              if (i < repeat) {
                c.endByte = startAddress + numE - 1;
                c.numByte = numE;
                chunkPot.chunks.push(c);
              } else if (i == repeat && endS > 0) {
                c.endByte = startAddress + endS - 1;
                c.numByte = endS;
                chunkPot.chunks.push(c);
              }
            }
            return chunkPot;
          };

          const getLocation = function() {
            return new Promise((resolve, reject) => {
              const resource = this.obj.resource;
              const accessToken = resource.accessToken;
              let metadata = {
                mimeType: resource.fileType,
                name: resource.fileName,
              };
              if ("lastModified" in resource && resource.lastModified != "") {
                metadata.modifiedTime = resource.lastModified;
              }
              if ("folderId" in resource && resource.folderId != "") {
                metadata.parents = [resource.folderId];
              }
              fetch(this.endpoint, {
                  method: "POST",
                  body: JSON.stringify(metadata),
                  headers: {
                    Authorization: "Bearer " + accessToken,
                    "Content-Type": "application/json",
                  }
                })
                .then((res) => {
                  if (res.status != 200) {
                    res.json().then((e) => reject(e));
                    return;
                  }
                  resolve(res.headers);
                })
                .catch((err) => {
                  reject(err);
                });
            });
          };

          const doUpload = function(chunks, callback) {
            callback({
              status: "start"
            }, null);
            const location = this.location;
            const end = chunks.length;
            let cnt = 0;
            const doFetch = function(cnt) {
              const e = chunks[cnt];
              callback({
                  status: "Uploading",
                  progressNumber: {
                    current: cnt,
                    end: end
                  },
                  progressByte: {
                    current: e.startByte,
                    end: e.endByte,
                    total: e.total,
                  },
                },
                null
              );
              fetch(location, {
                  method: "PUT",
                  body: e.data,
                  headers: {
                    "Content-Range": e.range,
                  }
                })
                .then((res) => {
                  const status = res.status;
                  cnt += 1;
                  if (status == 308) {
                    doFetch(cnt);
                  } else if (status == 200) {
                    res
                      .json()
                      .then((r) => callback({
                        status: "Done",
                        result: r
                      }, null));
                  } else {
                    res.json().then((err) => {
                      err.additionalInformation =
                        "When the file size is large, there is the case that the file cannot be converted to Google Docs. Please be careful this.";
                      callback(null, err);
                      return;
                    });
                    return;
                  }
                })
                .catch((err) => {
                  callback(null, err);
                  return;
                });
            };
            doFetch(cnt);
          };

          return ResumableUploadToGoogleDrive;
        })();

        return (r.ResumableUploadToGoogleDrive = ResumableUploadToGoogleDrive);
      })(this);
    </script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <style>
      .dropzone {
        border: 2px dashed #e2e8f0;
        transition: all 0.3s ease;
        background-color: white;
      }

      .dropzone.active,
      .dropzone:hover {
        border-color: #4f46e5;
        background-color: #f5f3ff;
      }

      .dropzone:active {
        transform: scale(0.98);
      }

      .progress-bar {
        transition: width 0.3s ease;
      }

      [id^="file-progress-"] {
        transition: width 0.3s ease;
      }

      .file-item:hover .file-actions,
      .file-item .file-actions:focus-within {
        opacity: 1;
      }

      .animate-pulse {
        animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
      }

      @keyframes pulse {

        0%,
        100% {
          opacity: 1;
        }

        50% {
          opacity: 0.5;
        }
      }

      @keyframes fadeOut {
        from {
          opacity: 1;
        }

        to {
          opacity: 0;
        }
      }

      .fade-out {
        animation: fadeOut 0.5s ease-out forwards;
      }

      .lang-toggle-container {
        position: relative;
        width: 68px;
        height: 32px;
        background-color: rgba(255, 255, 255, 0.2);
        border-radius: 8px;
        cursor: pointer;
      }

      .lang-toggle-container::after {
        content: '';
        position: absolute;
        width: 32px;
        height: 32px;
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        left: 0px;
        top: 0;
        z-index: 0;
        transition: transform 0.3s ease;
      }

      .lang-toggle-container.en::after {
        transform: translateX(36px);
      }

      .lang-button {
        position: absolute;
        width: 32px;
        height: 32px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 1;
        background: transparent;
        transition: color 0.3s ease;
        top: 0;
      }

      .lang-button.active {
        color: #4f46e5;
        font-weight: 600;
      }

      .lang-button.inactive {
        color: rgba(255, 255, 255, 0.7);
      }

      #langDE {
        left: 0;
      }

      #langEN {
        right: 0;
      }
    </style>
  </head>

  <body
    class="font-inter bg-gray-50 min-h-screen flex items-center justify-center p-4"
  >
    <form
      class="w-full max-w-md bg-white rounded-xl shadow-lg overflow-hidden transition-all duration-300"
    >
      <!-- Header -->
      <div
        class="bg-gradient-to-r from-indigo-600 to-indigo-500 p-6 text-white"
      >
        <div class="flex items-center space-x-4">
          <img width="50px" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPoAAAB3CAMAAAAdHK0JAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAMAUExURUdwTP///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////2Xj7zwAAAD/dFJOUwAB/vVmCswDM5n9C5j7CfYF8AZlDPjdDgT3LgLz6/qaE2dBahEhDUjyNweQ4CImnM3U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"></img>
          <div class="flex-grow">
            <h1 class="text-2xl font-semibold">Drive Mutli Upload</h1>
          </div>
          <button
            class="lang-toggle-container en"
            onclick="toggleLanguage()"
            type="button"
          >
            <div id="langDE" class="lang-button">🇩🇪</div>
            <div id="langEN" class="lang-button">🇬🇧</div>
          </button>
        </div>
        <p class="text-indigo-100 text-sm mt-5">
          Upload files to Google Drive
        </p>
      </div>

      <!-- Main Form -->
      <div class="p-6" id="forminner">
        <div class="mb-6" id="folderInput">
          <div class="relative">
            <input
              type="text"
              id="folderName"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition"
              placeholder="Enter folder name"
            />
            <div
              class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none"
            >
              <span class="material-icons text-gray-400">folder</span>
            </div>
          </div>
          <div id="folderError" class="text-red-500 text-sm mt-1 hidden"></div>
        </div>

        <!-- Dropzone -->
        <div class="mb-1">
          <button
            id="dropzone"
            type="button"
            class="w-full dropzone rounded-lg p-8 text-center mb-1 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"
          >
            <input type="file" id="fileInput" class="hidden" multiple />
            <div class="flex items-center justify-center gap-0 w-full">
              <span
                class="material-icons text-indigo-500 text-4xl flex-shrink-0"
                >upload_file</span
              >
              <div class="flex-1 min-w-0">
                <h3 class="text-lg font-medium text-gray-800 truncate">
                  Drag & drop files here
                </h3>
                <p class="text-sm text-gray-500 mt-1 truncate">
                  or click to browse files
                </p>
              </div>
            </div>
          </button>
          <div id="filesError" class="text-red-500 text-sm mb-3 hidden"></div>
        </div>

        <!-- Selected Files -->
        <div id="fileList" class="space-y-2 max-h-48 overflow-y-auto hidden">
          <div id="filesContainer" class="space-y-2"></div>
        </div>

        <!-- Upload Button -->
        <button
          id="uploadBtn"
          type="button"
          onclick="submitForm(event)"
          class="w-full mt-6 px-6 py-3 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed"
        >
          <span id="uploadBtnText">Upload Files</span>
          <span class="material-icons ml-2">send</span>
        </button>
      </div>

      <!-- Upload Progress -->
      <div id="uploadProgress" class="hidden p-6 border-t border-gray-200">
        <div id="uploadHeader" class="flex items-center justify-between mb-2">
          <div>
            <h3 class="font-medium text-gray-800">Uploading Files</h3>
          </div>
          <span id="progressPercent" class="text-sm font-medium text-indigo-600"
            >0%</span
          >
        </div>
        <div class="w-full bg-gray-200 rounded-full h-2.5 mb-4 overflow-hidden">
          <div
            id="progressBar"
            class="progress-bar bg-indigo-600 h-2.5 rounded-full"
            style="width: 0%"
          ></div>
        </div>

        <div id="uploadError" class="text-red-500 text-sm mb-3 hidden"></div>

        <div id="uploadStats" class="mt-4 grid grid-cols-2 gap-4 text-sm">
          <div class="bg-gray-50 p-3 rounded-lg">
            <div class="text-gray-500">Files Uploaded</div>
            <div class="font-medium text-gray-800">
              <span id="uploadedFiles">0</span>/<span id="totalFiles">0</span>
            </div>
          </div>
          <div class="bg-gray-50 p-3 rounded-lg">
            <div class="text-gray-500">Total Size</div>
            <div id="totalSize" class="font-medium text-gray-800">0 MB</div>
          </div>
        </div>

        <div id="successState" class="hidden mt-6 text-center">
          <button
            onclick="resetForm()"
            type="button"
            class="w-full px-6 py-2 bg-white border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition"
          >
            Upload More Files
          </button>
        </div>
      </div>
    </form>

    <script>
      // DOM Elements
      const dropzone = document.getElementById('dropzone');
      const fileInput = document.getElementById('fileInput');
      const browseBtn = document.getElementById('browseBtn');
      const uploadBtn = document.getElementById('uploadBtn');
      const folderName = document.getElementById('folderName');
      const fileList = document.getElementById('fileList');
      const filesContainer = document.getElementById('filesContainer');
      const forminner = document.getElementById('forminner');
      const uploadProgress = document.getElementById('uploadProgress');
      const successMessage = document.getElementById('successMessage');
      const progressBar = document.getElementById('progressBar');
      const progressPercent = document.getElementById('progressPercent');
      const filesUploaded = document.getElementById('filesUploaded');
      const totalSize = document.getElementById('totalSize');

      const parentFolderId = "1QNhoBaXmfBbnVNHttk4MClbV2fAYqRNV"; // creates a folder inside of this folder
      childFolderId = ""; // upload files here once set by createFolder()
      let currentLanguage = '';
      let selectedFiles = [];
      let totalFilesSize = 0;
      let completedFilesCount = 0;
      let fileProgress = [];

      /**
       * Event reseting previously shown error
       */
      folderName.addEventListener('input', () => {
        document.getElementById('folderError').classList.add('hidden');
      });

      /*************** Begin of events regarding adding files ****************/

      dropzone.addEventListener('click', () => fileInput.click());

      fileInput.addEventListener('change', handleFileSelect);

      ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        dropzone.addEventListener(eventName, preventDefaults, false);
      });

      function preventDefaults(event) {
        event.preventDefault();
        event.stopPropagation();
      }

      ['dragenter', 'dragover'].forEach(eventName => {
        dropzone.addEventListener(eventName, highlight, false);
      });

      ['dragleave', 'drop'].forEach(eventName => {
        dropzone.addEventListener(eventName, unhighlight, false);
      });

      dropzone.addEventListener('drop', handleDrop, false);

      function highlight() {
        dropzone.classList.add('active');
      }

      function unhighlight() {
        dropzone.classList.remove('active');
      }

      function handleDrop(event) {
        const dt = event.dataTransfer;
        const files = dt.files;
        addFiles(files);
      }

      function handleFileSelect(event) {
        addFiles(event.target.files);
      }

      /*************** End of events regarding adding files ****************/

      /**
       * Adds one or multiple files to selectedFiles
       */
      function addFiles(files) {
        selectedFiles.push(...Array.from(files));
        totalFilesSize = selectedFiles.reduce((sum, file) => sum + file.size, 0);

        updateFileList();
        updateTotalSize();

        if (selectedFiles.length > 0) {
          fileList.classList.remove('hidden');
          document.getElementById('filesError').classList.add('hidden');
        }
      }

      /**
       * Updates the file preview list based on current state of selectedFiles
       */
      function updateFileList() {
        filesContainer.innerHTML = '';

        selectedFiles.forEach((file, index) => {
          const fileElement = document.createElement('div');
          fileElement.className = 'file-item flex items-center justify-between p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition';

          fileElement.innerHTML = `
                      <div class="flex items-center truncate">
                          <span class="material-icons text-gray-500 mr-2 text-base">${getFileIcon(file.type)}</span>
                          <span class="truncate text-sm text-gray-700">${file.name}</span>
                      </div>
                      <div class="file-actions opacity-0 flex items-center transition whitespace-nowrap">
                          <span class="text-xs text-gray-500 mr-2">${formatFileSize(file.size)}</span>
                          <button onclick="removeFile(${index})" class="text-red-500 hover:text-red-700 transition">
                              <span class="material-icons text-base">close</span>
                          </button>
                      </div>
                      <div class="absolute bottom-0 left-0 right-0 h-1 bg-gray-200 rounded-b-lg overflow-hidden">
                          <div id="file-progress-${index}" class="h-full bg-indigo-500 transition-all duration-300" style="width: 0%"></div>
                      </div>
                  `;
          fileElement.className = 'file-item flex items-center justify-between p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition relative';

          filesContainer.appendChild(fileElement);
        });
      }

      /**
       * Remove a file from seelectedFiles
       */
      function removeFile(index) {
        totalFilesSize -= selectedFiles[index].size;
        selectedFiles.splice(index, 1);

        if (selectedFiles.length === 0) {
          fileList.classList.add('hidden');
        } else {
          updateFileList();
        }

        updateTotalSize();
      }

      /**
       * Provide a icon based on file type
       * RegEx expression encoded as Base64 because of issues with Google script host
       */
      function getFileIcon(type) {
        if (type.match(new RegExp(atob('aW1hZ2VcLyo=')))) return 'image';
        if (type.match(new RegExp(atob('dmlkZW9cLyo=')))) return 'videocam';
        if (type.match(new RegExp(atob('YXVkaW9cLyo=')))) return 'audiotrack';
        if (type.match(new RegExp(atob('cGRmXC8q')))) return 'picture_as_pdf';
        if (type.match(new RegExp(atob('dGV4dFwvKg==')))) return 'description';
        if (type.match(new RegExp(atob('emlwXC8q'))) || type.match(new RegExp(atob('Y29tcHJlc3NlZFwvKg==')))) return 'folder_zip';
        return 'insert_drive_file';
      }

      /**
       * Return a written format of a byte amount
       */
      function formatFileSize(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
      }

      /**
       * Function to update the overall total size value
       */
      function updateTotalSize() {
        totalSize.textContent = formatFileSize(totalFilesSize);
      }

      /**
       * make prechecks
       * "switch" to upload screen
       * start upload
       */
      async function submitForm(event) {
        event.preventDefault();

        // Clear any existing errors
        document.getElementById('folderError').classList.add('hidden');
        document.getElementById('filesError').classList.add('hidden');

        let hasErrors = false;

        // Validate form
        if (!folderName.value.trim()) {
          showError("folderError");
          hasErrors = true;
        }

        if (selectedFiles.length === 0) {
          showError("filesError");
          hasErrors = true;
        }

        if (hasErrors) return;

        // Disable form and hide file selection/delete buttons and upload button
        uploadBtn.classList.add('hidden');
        document.getElementById('folderInput').classList.add('hidden');
        document.getElementById('dropzone').classList.add('hidden');
        document.querySelectorAll('.file-actions button').forEach(btn => {
          btn.disabled = true;
          btn.style.display = 'none';
        });

        // Show progress
        uploadProgress.classList.remove('hidden');
        completedFilesCount = 0;
        fileProgress = [];

        // Update initial stats
        document.getElementById('uploadedFiles').textContent = '0';
        document.getElementById('totalFiles').textContent = selectedFiles.length;

        try {
          createFolderAndUpload(folderName, parentFolderId);
        } catch (error) {
          console.error(error);
          document.getElementById('successState').classList.remove('hidden');
          showError("uploadError");
        }
      }

      /**
       * Call to the DriveApp api and create new folder.
       * After that call upload()
       */
      function createFolderAndUpload(folderName, parentFolderId) {
        var folderName = document.getElementById('folderName').value;
        google.script.run.withSuccessHandler(
          response => {
            childFolderId = response; // childFolderId is global and available to other functions
            upload();
          }
        ).createFolder(folderName, parentFolderId);
      }

      /**
       * Function preparing and precessing details of the upload
       * Called by createFolderAndUpload()
       */
      function upload(accessToken) {
        google.script.run.withSuccessHandler(accessToken => {
          try {
            selectedFiles.forEach((file, i) => {
              let fileReader = new FileReader();
              fileReader.fileName = file.name;
              fileReader.fileSize = file.size;
              fileReader.fileType = file.type;
              const lastModified = new Date(file.lastModified).toISOString();
              fileReader.readAsArrayBuffer(file);
              fileReader.onload = event => {
                var index = i;
                fileProgress[index] = 0;
                const f = event.target;
                const resource = {
                  fileName: f.fileName,
                  fileSize: f.fileSize,
                  fileType: f.fileType,
                  folderId: childFolderId,
                  fileBuffer: f.result,
                  lastModified: lastModified,
                  accessToken: accessToken
                };
                // Provided by the imported script library
                const resumableUpload = new ResumableUploadToGoogleDrive();
                resumableUpload.Do(resource, function(res, err) {
                  if (err) {
                    console.error(err);
                    document.getElementById('successState').classList.remove('hidden');
                    showError("uploadError");
                    return;
                  }

                  console.log(res);

                  if (res.status == "Uploading") {
                    fileProgress[index] = Math.round(
                      (res.progressNumber.current / res.progressNumber.end) * 100
                    );
                  }

                  if (res.status == "Done") {
                    fileProgress[index] = 100;
                  }

                  // Update UI
                  document.getElementById(`file-progress-${index}`).style.width = `${fileProgress[index]}%`;

                  const totalProgress = fileProgress.reduce((sum, p) => sum + p, 0);
                  const overallProgress = Math.floor(totalProgress / selectedFiles.length);
                  if (overallProgress >= 100) {
                    document.getElementById('successState').classList.remove('hidden');
                  }
                  progressBar.style.width = `${overallProgress}%`;
                  progressPercent.textContent = `${overallProgress}%`;

                  if (fileProgress[index] >= 100) {
                    completedFilesCount++;
                    document.getElementById('uploadedFiles').textContent = completedFilesCount;
                  }
                });
              };
            });

          } catch (error) {
            console.error(error);
            document.getElementById('successState').classList.remove('hidden');
            showError("uploadError");
          }
        }).getOAuthToken();
      }

      /**
       * Function shows respective error types
       */
      function showError(errorType) {
        // Show error under the appropriate field
        if (errorType == "folderError") {
          const folderError = document.getElementById('folderError');
          folderError.textContent = translations[currentLanguage].errorNoFolder;
          folderError.classList.remove('hidden');
        } else if (errorType == "filesError") {
          const filesError = document.getElementById('filesError');
          filesError.textContent = translations[currentLanguage].errorNoFiles;
          filesError.classList.remove('hidden');
        } else if (errorType == "uploadError") {
          const uploadError = document.getElementById('uploadError');
          uploadError.textContent = translations[currentLanguage].errorUpload;
          uploadError.classList.remove('hidden');
        }
      }

      /**
       * Function resets form into its intial state
       */
      function resetForm() {
        // Reset form and clear errors
        folderName.value = '';
        document.getElementById('folderError').textContent = translations[currentLanguage].errorNoFolder;
        document.getElementById('folderError').classList.add('hidden');
        document.getElementById('filesError').textContent = translations[currentLanguage].errorNoFiles;
        document.getElementById('filesError').classList.add('hidden');
        document.getElementById('uploadError').textContent = translations[currentLanguage].errorUpload;
        document.getElementById('uploadError').classList.add('hidden');
        selectedFiles = [];
        totalFilesSize = 0;
        fileProgress = [];
        fileInput.value = '';
        filesContainer.innerHTML = '';
        document.querySelectorAll('[id^="file-progress-"]').forEach(el => {
          el.style.width = '0%';
        });
        fileList.classList.add('hidden');
        // Reset progress bar
        const progressBar = document.getElementById('progressBar');
        progressBar.style.width = '0%';
        progressBar.classList.remove('bg-green-500');
        progressBar.classList.add('bg-indigo-600');
        document.getElementById('progressPercent').textContent = '0%';
        completedFilesCount = 0;
        totalSize.textContent = '0 MB';

        // Reset progress UI
        document.getElementById('uploadHeader').classList.remove('hidden');
        document.getElementById('progressBar').classList.remove('hidden');
        document.getElementById('uploadStats').classList.remove('hidden');
        document.getElementById('successState').classList.add('hidden');

        // Show form again
        uploadProgress.classList.add('hidden');
        forminner.classList.remove('hidden');
        uploadBtn.classList.remove('hidden');
        document.getElementById('folderInput').classList.remove('hidden');
        document.getElementById('dropzone').classList.remove('hidden');
        uploadBtn.disabled = false;

        // Restore file actions
        document.querySelectorAll('.file-actions button').forEach(btn => {
          btn.disabled = false;
          btn.style.display = '';
        });
      }

      /**
       * Variable holds all translations for german and english
       */
      const translations = {
        de: {
          title: "GLR Uploader",
          subtitle: "Lade Fotos und auch Videos von unseren Events hoch. Events umfassen z.B. Samstagstreffs, Sponsorentreffen oder auch FS Schweiz bzw. FS Germany. Die Dateien werden später in Sciebo gespeichert.",
          folderName: "Bezeichnung",
          folderPlaceholder: "Bezeichnung eingeben",
          dropzoneTitle: "Dateien hier ablegen",
          dropzoneSubtitle: "oder klicken, um Dateien auszuwählen",
          browseBtn: "Dateien auswählen",
          selectedFiles: "Ausgewählte Dateien",
          uploadBtn: "Dateien hochladen",
          uploadingFiles: "Dateien hochladen",
          filesUploaded: "Hochgeladene Dateien",
          totalSize: "Gesamtgröße",
          uploadMore: "Weitere Dateien hochladen",
          errorNoFolder: "Bitte geben Sie eine Bezeichnung ein",
          errorNoFiles: "Bitte wählen Sie mindestens eine Datei aus",
          errorUpload: "Fehler beim Hochladen"
        },
        en: {
          title: "GLR Uploader",
          subtitle: "Upload photos and videos from our events. Events include, for example, Saturday get-togethers, sponsor meetings, or FS Switzerland and FS Germany. The files will be saved in Sciebo later.",
          folderName: "Label",
          folderPlaceholder: "Enter label",
          dropzoneTitle: "Drag & drop files here",
          dropzoneSubtitle: "or click to browse files",
          browseBtn: "Select Files",
          selectedFiles: "Selected Files",
          uploadBtn: "Upload Files",
          uploadingFiles: "Uploading Files",
          filesUploaded: "Files Uploaded",
          totalSize: "Total Size",
          uploadMore: "Upload More Files",
          errorNoFolder: "Please enter a label name",
          errorNoFiles: "Please select at least one file to upload",
          errorUpload: "Upload Error"
        }
      };

      /**
       * Function updates all strings based on the current language selected
       */
      function updateTexts() {
        const translation = translations[currentLanguage];
        // Update header texts
        document.querySelector('h1').textContent = translation.title;
        document.querySelector('p.text-indigo-100').textContent = translation.subtitle;

        // Update form elements
        document.getElementById('folderName').placeholder = translation.folderPlaceholder;
        document.querySelector('#dropzone h3').textContent = translation.dropzoneTitle;
        document.querySelector('#dropzone p').textContent = translation.dropzoneSubtitle;
        document.getElementById('uploadBtnText').textContent = translation.uploadBtn;

        // Update progress section
        document.querySelector('#uploadHeader h3').textContent = translation.uploadingFiles;
        document.querySelector('#uploadStats div:first-child div:first-child').textContent = translation.filesUploaded;
        document.querySelector('#uploadStats div:last-child div:first-child').textContent = translation.totalSize;
        document.querySelector('#successState button').textContent = translation.uploadMore;

        // Update error messages
        document.getElementById('folderError').textContent = translation.errorNoFolder;
        document.getElementById('filesError').textContent = translation.errorNoFiles;
        document.getElementById('uploadError').textContent = translation.errorUpload;
      }

      /**
       * Function toggles current language between english and german
       */
      function toggleLanguage() {
        currentLanguage = currentLanguage === 'de' ? 'en' : 'de';
        document.documentElement.lang = currentLanguage;

        // Update toggle container class for animation
        const container = document.querySelector('.lang-toggle-container');
        container.classList.toggle('en');

        updateTexts();
      }

      // Initialize with German
      toggleLanguage();
    </script>
  </body>
</html>
